!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e(t.constate={},t.React)}(this,function(t,s){"use strict";var n=s.createContext({state:{}}),o=n.Consumer;function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(t){u(e,t,n[t])})}return e}function r(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=Object.keys;function d(t,e){return"function"==typeof t?t(e):t}var c=function(i){function t(t){var c;u(f(f(c=i.call(this,t)||this)),"state",c.props.initialState),u(f(f(c)),"ignoreState",!1),u(f(f(c)),"unmount",void 0),u(f(f(c)),"getEffectProps",function(n){var t=c.props,e=t.context,o=t.state;return{state:e&&o?o:c.state,setState:function(t,e){return c.handleSetState(t,e,n)}}}),u(f(f(c)),"handleSetState",function(e,r,i){var s,t=c.props,n=t.context,o=t.setContextState,a=function(t){return d(e,s=t)},u=function(){var t=c.props,e=t.state,n=void 0===e?c.state:e,o=t.onUpdate;o&&c.ignoreState!==n&&o(p({},c.getEffectProps("onUpdate"),{prevState:s,type:i})),r&&r()};n&&o?o(n,a,u,i):c.setState(a,u)});var e=t.context,n=t.setContextState,o=t.state,r=t.initialState;return e&&n&&!o&&n(e,function(t){return Object.assign({},r,t)},void 0,"initialState"),c}r(t,i);var e=t.prototype;return e.componentDidMount=function(){var t=this,e=this.props,n=e.context,o=e.mountContainer,r=e.onMount,i=function(){return r&&r(t.getEffectProps("onMount"))};n&&o?this.unmount=o(n,i):n||i()},e.shouldComponentUpdate=function(t,e){var n=this.props,o=n.pure,r=n.context,i=n.state,s=t.state,a=t.shouldUpdate,u=!0;return r&&i&&s?(u=!o||i!==s)&&a&&(u=a({state:i,nextState:s}),this.ignoreState=!u&&s):r||(u=!o||this.state!==e)&&a&&(u=a({state:this.state,nextState:e}),this.ignoreState=!u&&e),u},e.componentWillUnmount=function(){var t=this,e=this.props,n=e.context,o=e.onUnmount,r=function(){return o&&o(t.getEffectProps("onUnmount"))};this.unmount?this.unmount(r):n||r()},e.render=function(){var o,r,i,s,a,u,t=this.props,e=t.state,n=t.children,c=t.actions,p=t.selectors,f=t.effects;return n(Object.assign({},e||this.state,c&&(a=this.handleSetState,l(u=c).reduce(function(t,e){var n;return Object.assign(t,((n={})[e]=function(){return a(u[e].apply(u,arguments),void 0,e)},n))},{})),p&&(i=e||this.state,l(s=p).reduce(function(t,e){var n;return Object.assign(t,((n={})[e]=function(){return s[e].apply(s,arguments)(i)},n))},{})),f&&(o=this.getEffectProps,l(r=f).reduce(function(t,e){var n;return Object.assign(t,((n={})[e]=function(){return r[e].apply(r,arguments)(o(e))},n))},{}))))},t}(s.Component);u(c,"defaultProps",{initialState:{}});var e=function(t){function e(){return t.apply(this,arguments)||this}return r(e,t),e.prototype.render=function(){var r=this,i=this.props.context;return void 0!==i?s.createElement(o,null,function(t){var e=t.state,n=t.setContextState,o=t.mountContainer;return s.createElement(c,a({},r.props,{state:e[i],setContextState:n,mountContainer:o}))}):s.createElement(c,this.props)},e}(s.Component),i="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__,v=function(o){function t(t){var a;u(f(f(a=o.call(this,t)||this)),"containers",{}),u(f(f(a)),"devtools",void 0),u(f(f(a)),"mountContainer",function(e,t){return a.containers[e]||(a.containers[e]=0,t&&a.setState(null,t)),a.containers[e]+=1,function(t){1===a.containers[e]&&t&&t(),a.containers[e]-=1}}),u(f(f(a)),"setContextState",function(n,o,r,i){var s;a.setState(function(t){var e;return s=t.state,{state:Object.assign({},t.state,(e={},e[n]=Object.assign({},t.state[n],d(o,t.state[n]||{})),e))}},function(){if(a.props.onUpdate){var t=p({},a.getProps("Provider/onUpdate"),{prevState:s,context:n,type:i});a.props.onUpdate(t)}if(r&&r(),a.devtools&&i){var e=n?n+"/"+i:i;a.devtools.send(e,a.state.state)}})}),u(f(f(a)),"getProps",function(o){var t=a.state,e=t.state,r=t.setContextState;return{state:e,setContextState:function(o){function t(t,e,n){return o.apply(this,arguments)}return t.toString=function(){return o.toString()},t}(function(t,e,n){return r(t,e,n,o)})}});var e=t.devtools,n=t.initialState;return a.state={state:n,mountContainer:a.mountContainer,setContextState:a.setContextState},e&&i&&(a.devtools=i.connect({name:"Context"}),a.devtools.init(n),a.devtools.subscribe(function(e){"DISPATCH"===e.type&&e.state&&a.setState(function(t){return{state:Object.assign({},t.state,JSON.parse(e.state))}})})),a}r(t,o);var e=t.prototype;return e.componentDidMount=function(){this.props.onMount&&this.props.onMount(this.getProps("Provider/onMount"))},e.componentWillUnmount=function(){if(this.props.onUnmount){var t=this.getProps(),e=(t.setContextState,function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,["setContextState"]));this.props.onUnmount(e)}this.devtools&&i&&(this.devtools.unsubscribe(),i.disconnect())},e.render=function(){return s.createElement(n.Provider,{value:this.state},this.props.children)},t}(s.Component);u(v,"defaultProps",{initialState:{}}),t.Consumer=o,t.Container=e,t.Provider=v,Object.defineProperty(t,"__esModule",{value:!0})});
